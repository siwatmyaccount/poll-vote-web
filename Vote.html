<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏•</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap');
    
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
      min-height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .container {
      background: white;
      border-radius: 16px;
      padding: 30px 40px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      text-align: center;
    }
    h1 {
      color: #2e7d32;
      margin-bottom: 24px;
      font-weight: 700;
      font-size: 2.5rem;
      letter-spacing: 1.2px;
    }
    input[type="text"] {
      width: 100%;
      padding: 14px 16px;
      margin: 12px 0;
      border: 2px solid #a5d6a7;
      border-radius: 10px;
      font-size: 1.1rem;
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus {
      border-color: #4caf50;
      outline: none;
      box-shadow: 0 0 8px rgba(76,175,80,0.4);
    }
    button {
      margin-top: 16px;
      width: 100%;
      padding: 14px;
      font-size: 1.2rem;
      font-weight: 600;
      color: white;
      background: #4caf50;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(76,175,80,0.4);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    button:hover:not(:disabled) {
      background-color: #388e3c;
      box-shadow: 0 8px 20px rgba(56,142,60,0.6);
    }
    button:disabled {
      background-color: #a5d6a7;
      cursor: not-allowed;
      box-shadow: none;
    }
  </style>
</head>
<link rel="stylesheet" href="style.css">

<body>
  <div class="container">
    <h1>üìù ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏•‡πÇ‡∏´‡∏ß‡∏ï</h1>
    <input type="text" id="question" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà" oninput="checkForm()" />

    <div id="options">
      <input type="text" class="option-input" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 1" oninput="checkForm()" />
      <input type="text" class="option-input" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 2" oninput="checkForm()" />
    </div>

    <button id="addOptionBtn" onclick="addOption()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
    <button id="createPollBtn" onclick="createPoll()" disabled>‚úÖ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏ß‡∏ï</button>

    <div class="note">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 10 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
  </div>

  <script>
    const maxOptions = 10;

    window.onload = () => {
  const loggedInUser = sessionStorage.getItem('loggedInUser');  // <-- ‡πÉ‡∏ä‡πâ sessionStorage ‡πÅ‡∏ó‡∏ô localStorage
  if (!loggedInUser) {
    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
    window.location.href = 'login.html';
    return;
  }
  checkForm();
};

    function addOption() {
      const optionsDiv = document.getElementById('options');
      const currentOptions = optionsDiv.getElementsByClassName('option-input').length;

      if (currentOptions >= maxOptions) {
        alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 10 ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
        return;
      }
      const input = document.createElement('input');
      input.type = 'text';
      input.className = 'option-input';
      input.placeholder = '‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà';
      input.oninput = checkForm;
      optionsDiv.appendChild(input);
      checkForm();
    }

    function checkForm() {
      const question = document.getElementById('question').value.trim();
      const optionElements = document.getElementsByClassName('option-input');
      const options = Array.from(optionElements).map(opt => opt.value.trim()).filter(opt => opt);
      const createBtn = document.getElementById('createPollBtn');

      createBtn.disabled = !(question !== '' && options.length >= 2);
    }

    function createPoll() {
      const question = document.getElementById('question').value.trim();
      const optionElements = document.getElementsByClassName('option-input');
      const options = Array.from(optionElements).map(opt => opt.value.trim()).filter(opt => opt);

      if (question === '' || options.length < 2) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß');
        return;
      }

      const pollData = {
        question: question,
        options: options,
        votes: options.map(() => 0)
      };

      localStorage.setItem('currentPoll', JSON.stringify(pollData));
      localStorage.removeItem('hasVoted'); // ‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏´‡∏ß‡∏ï‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏û‡∏•‡πÉ‡∏´‡∏°‡πà
      window.location.href = 'poll.html';
    }

  </script>
     
</body>
</html>
